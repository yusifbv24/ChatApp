@page "/"
@attribute [Authorize]

@using ChatApp.Blazor.Client.Features.Auth.Services
@using ChatApp.Blazor.Client.Helpers

@inject UserState UserState

<PageTitle>Feed - ChatApp</PageTitle>

<div class="admin-page">

    @* ===== WELCOME HEADER ===== *@
    <div class="dash-welcome">
        <div class="dash-welcome-left">
            <div class="dash-welcome-avatar-wrapper">
                @if (!string.IsNullOrEmpty(UserState.CurrentUser?.AvatarUrl))
                {
                    <img src="@UserState.CurrentUser.AvatarUrl" alt="@UserState.CurrentUser.FullName" class="dash-welcome-avatar" />
                }
                else if (UserState.CurrentUser != null)
                {
                    <div class="dash-welcome-avatar-placeholder" style="background-color: @AvatarHelper.GetAvatarBackgroundColor(UserState.CurrentUser.Id);">
                        @StringHelper.GetInitials(UserState.CurrentUser.FullName)
                    </div>
                }
            </div>
            <div class="dash-welcome-info">
                <h1 class="dash-welcome-title">@GetGreeting(), @UserState.CurrentUser?.FirstName!</h1>
                <p class="dash-welcome-subtitle">
                    @if (!string.IsNullOrEmpty(UserState.CurrentUser?.Position))
                    {
                        <span>@UserState.CurrentUser.Position</span>
                    }
                    @if (!string.IsNullOrEmpty(UserState.CurrentUser?.DepartmentName))
                    {
                        <span> &bull; @UserState.CurrentUser.DepartmentName</span>
                    }
                </p>
            </div>
        </div>
        <div class="dash-welcome-right">
            <div class="dash-welcome-date">@DateTime.Now.ToString("dddd")</div>
            <div class="dash-welcome-date-full">@DateTime.Now.ToString("dd MMMM yyyy")</div>
        </div>
    </div>

    @* ===== COMING SOON ===== *@
    <div class="feed-coming-soon">
        <div class="feed-coming-soon-icon">
            <MudIcon Icon="@Icons.Material.Outlined.RocketLaunch" Style="font-size: 3.5rem; color: #667eea;" />
        </div>
        <h2 class="feed-coming-soon-title">We will implement soon</h2>
        <p class="feed-coming-soon-desc">The Feed is currently under development. Stay tuned for updates, announcements, and team activity right here.</p>
        <div class="feed-coming-soon-dots">
            <span class="feed-dot"></span>
            <span class="feed-dot"></span>
            <span class="feed-dot"></span>
        </div>
    </div>

</div>

@code {
    private string GetGreeting()
    {
        var hour = DateTime.Now.Hour;
        if (hour < 12) return "Good morning";
        if (hour < 17) return "Good afternoon";
        return "Good evening";
    }
}
