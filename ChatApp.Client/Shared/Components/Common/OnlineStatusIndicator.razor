@inject PresenceState PresenceState

@* Shows green/yellow/red/gray dot based on user's online status *@

@code {
    [Parameter]
    public Guid UserId { get; set; }

    [Parameter]
    public Size Size { get; set; } = Size.Small;

    private string Status => PresenceState.GetUserStatus(UserId);

    private Color GetStatusColor() => Status switch
    {
        "Online" => Color.Success,
        "Away" => Color.Warning,
        "Busy" => Color.Error,
        _ => Color.Dark
    };

    protected override void OnInitialized()
    {
        PresenceState.PropertyChanged += (s,e) => InvokeAsync(StateHasChanged);
    }
}

<MudBadge Color="@GetStatusColor()"
          Dot="true"
          Overlap="true"
          Origin="Origin.BottomRight"
          BadgeClass="@($"mud-badge-{Size.ToDescriptionString()}")">
    @ChildContent
</MudBadge>

@code {
    [Parameter]
    public RenderFragment? ChildContent { get; set; }
}
